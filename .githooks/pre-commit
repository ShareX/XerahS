#!/usr/bin/env sh
#
# Cross-platform pre-commit hook launcher.
# - Windows: delegates to PowerShell hook
# - Unix-like: delegates to bash hook
#

set -e

script_dir="$(cd "$(dirname "$0")" && pwd)"

uname_out="$(uname -s 2>/dev/null || echo unknown)"
case "$uname_out" in
  MINGW*|MSYS*|CYGWIN*)
    if command -v pwsh >/dev/null 2>&1; then
      exec pwsh -NoProfile -File "$script_dir/pre-commit.ps1"
    elif command -v powershell >/dev/null 2>&1; then
      exec powershell -NoProfile -ExecutionPolicy Bypass -File "$script_dir/pre-commit.ps1"
    else
      echo "PowerShell not found. Install pwsh or enable Windows PowerShell." >&2
      exit 1
    fi
    ;;
  *)
    if [ -x "$script_dir/pre-commit.bash" ]; then
      exec "$script_dir/pre-commit.bash"
    elif command -v bash >/dev/null 2>&1; then
      exec bash "$script_dir/pre-commit.bash"
    else
      echo "bash not found. Install bash to run the pre-commit hook." >&2
      exit 1
    fi
    ;;
esac