<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:XerahS.UI.ViewModels"
             xmlns:controls="using:XerahS.UI.Controls"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="XerahS.UI.Views.TaskSettingsPanel"
             x:DataType="vm:TaskSettingsViewModel">

    <Design.DataContext>
        <vm:SettingsViewModel/>
    </Design.DataContext>

    <Grid RowDefinitions="*" Margin="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
        <TabControl Grid.Row="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" MinHeight="300">
            <!-- General Tab -->
            <TabItem Header="General">
                <ScrollViewer>
                    <StackPanel Margin="20" Spacing="20">
                        <StackPanel Spacing="10">
                            <TextBlock Text="Notifications" FontWeight="SemiBold"/>
                            <Border BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" BorderThickness="1" CornerRadius="4" Padding="10">
                                <StackPanel Spacing="10">
                                    <CheckBox IsChecked="{Binding PlaySoundAfterCapture}" Content="Play sound after capture"/>
                                    <CheckBox IsChecked="{Binding PlaySoundAfterUpload}" Content="Play sound after upload"/>
                                    <CheckBox IsChecked="{Binding PlaySoundAfterAction}" Content="Play sound after action"/>
                                    <CheckBox IsChecked="{Binding ShowToastNotification}" Content="Show toast notification after task completed"/>
                                    
                                    <!-- Toast Settings -->
                                    <StackPanel Spacing="10" Margin="20,0,0,0" IsVisible="{Binding ShowToastNotification}">
                                        <Grid ColumnDefinitions="Auto, 10, Auto, 10, Auto, 20, Auto, 10, Auto, 10, Auto">
                                             <TextBlock Grid.Column="0" Text="Duration:" VerticalAlignment="Center"/>
                                             <NumericUpDown Grid.Column="2" Value="{Binding ToastWindowDuration}" Minimum="0.5" Maximum="30" Increment="0.5" FormatString="0.0" Width="80"/>
                                             <TextBlock Grid.Column="4" Text="seconds" VerticalAlignment="Center"/>
                                            
                                             <TextBlock Grid.Column="6" Text="Fade duration:" VerticalAlignment="Center"/>
                                             <NumericUpDown Grid.Column="8" Value="{Binding ToastWindowFadeDuration}" Minimum="0" Maximum="5" Increment="0.1" FormatString="0.0" Width="80"/>
                                             <TextBlock Grid.Column="10" Text="seconds" VerticalAlignment="Center"/>
                                        </Grid>

                                        <CheckBox IsChecked="{Binding ToastWindowAutoHide}" Content="Auto hide toast notification"/>

                                        <Grid ColumnDefinitions="Auto, 10, *, 20, Auto, 10, Auto, 5, Auto, 5, Auto">
                                            <TextBlock Grid.Column="0" Text="Placement:" VerticalAlignment="Center"/>
                                            <ComboBox Grid.Column="2" ItemsSource="{Binding ContentAlignments}" SelectedItem="{Binding ToastWindowPlacement}" HorizontalAlignment="Stretch"/>
                                            
                                            <TextBlock Grid.Column="4" Text="Size:" VerticalAlignment="Center"/>
                                            <NumericUpDown Grid.Column="6" Value="{Binding ToastWindowWidth}" Minimum="100" Maximum="2000" Increment="10" Width="80"/>
                                            <TextBlock Grid.Column="8" Text="x" VerticalAlignment="Center"/>
                                            <NumericUpDown Grid.Column="10" Value="{Binding ToastWindowHeight}" Minimum="50" Maximum="1000" Increment="10" Width="80"/>
                                        </Grid>

                                        <Grid ColumnDefinitions="Auto, 10, *">
                                            <TextBlock Grid.Column="0" Text="Left click action:" VerticalAlignment="Center"/>
                                            <ComboBox Grid.Column="2" ItemsSource="{Binding ToastClickActions}" SelectedItem="{Binding ToastWindowLeftClickAction}" HorizontalAlignment="Stretch"/>
                                        </Grid>

                                        <Grid ColumnDefinitions="Auto, 10, *">
                                            <TextBlock Grid.Column="0" Text="Middle click action:" VerticalAlignment="Center"/>
                                            <ComboBox Grid.Column="2" ItemsSource="{Binding ToastClickActions}" SelectedItem="{Binding ToastWindowMiddleClickAction}" HorizontalAlignment="Stretch"/>
                                        </Grid>

                                        <Grid ColumnDefinitions="Auto, 10, *">
                                            <TextBlock Grid.Column="0" Text="Right click action:" VerticalAlignment="Center"/>
                                            <ComboBox Grid.Column="2" ItemsSource="{Binding ToastClickActions}" SelectedItem="{Binding ToastWindowRightClickAction}" HorizontalAlignment="Stretch"/>
                                        </Grid>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <StackPanel Spacing="10">
                            <TextBlock Text="Sound" FontWeight="SemiBold"/>
                            <Border BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" BorderThickness="1" CornerRadius="4" Padding="10">
                                <StackPanel Spacing="10">
                                    <CheckBox IsChecked="{Binding UseCustomCaptureSound}" Content="Use custom capture sound"/>
                                    <Grid ColumnDefinitions="Auto, 10, *" IsVisible="{Binding UseCustomCaptureSound}">
                                        <TextBlock Grid.Column="0" Text="Path:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="2" Text="{Binding CustomCaptureSoundPath}"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>


            <!-- Capture Tab -->
            <TabItem Header="Capture">
                <ScrollViewer>
                    <StackPanel Margin="20" Spacing="20">
                        <StackPanel Spacing="10">
                            <TextBlock Text="General" FontWeight="SemiBold"/>
                            <Border BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" BorderThickness="1" CornerRadius="4" Padding="10">
                                <StackPanel Spacing="10">
                                    <CheckBox IsChecked="{Binding UseModernCapture}" Content="Use modern screen capture (Direct3D11)"/>
                                    <CheckBox IsChecked="{Binding ShowCursor}" Content="Show cursor in screenshots"/>
                                    <Grid ColumnDefinitions="Auto, 15, 120, 15, Auto">
                                         <TextBlock Grid.Column="0" Text="Screenshot delay:" VerticalAlignment="Center"/>
                                         <NumericUpDown Grid.Column="2" Value="{Binding ScreenshotDelay}" Minimum="0" Maximum="60" Increment="0.1" FormatString="0.0" MinWidth="120"/>
                                         <TextBlock Grid.Column="4" Text="seconds" VerticalAlignment="Center"/>
                                    </Grid>
                                    <CheckBox IsChecked="{Binding CaptureTransparent}" Content="Capture transparency"/>
                                    <CheckBox IsChecked="{Binding CaptureShadow}" Content="Capture window shadow" IsEnabled="{Binding CaptureTransparent}" Margin="20,0,0,0"/>
                                    <CheckBox IsChecked="{Binding CaptureClientArea}" Content="Capture client area (remove window chrome)"/>
                                    <CheckBox IsChecked="{Binding CaptureAutoHideTaskbar}" Content="Auto hide taskbar during capture"/>
                                    <Grid ColumnDefinitions="Auto, 10, *">
                                         <TextBlock Grid.Column="0" Text="Window title:" VerticalAlignment="Center"/>
                                         <TextBox Grid.Column="2" Text="{Binding CaptureCustomWindow, UpdateSourceTrigger=PropertyChanged}" Watermark="Window title to capture (CustomWindow job)"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <StackPanel Spacing="10">
                            <TextBlock Text="Screen recorder" FontWeight="SemiBold"/>
                            <Border BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" BorderThickness="1" CornerRadius="4" Padding="10">
                                <StackPanel Spacing="10">
                                    <Grid ColumnDefinitions="Auto, 15, 120, 15, Auto">
                                         <TextBlock Grid.Column="0" Text="FPS:" VerticalAlignment="Center"/>
                                         <NumericUpDown Grid.Column="2" Value="{Binding ScreenRecordFPS}" Minimum="1" Maximum="144" Increment="1" MinWidth="120"/>
                                    </Grid>
                                    <Grid ColumnDefinitions="Auto, 15, 120, 15, Auto">
                                         <TextBlock Grid.Column="0" Text="Duration:" VerticalAlignment="Center"/>
                                         <NumericUpDown Grid.Column="2" Value="{Binding ScreenRecordDuration}" Minimum="0" Maximum="3600" Increment="1" MinWidth="120"/>
                                         <TextBlock Grid.Column="4" Text="seconds (0 to disable)" VerticalAlignment="Center"/>
                                    </Grid>
                                    <Grid ColumnDefinitions="Auto, 15, 120, 15, Auto">
                                         <TextBlock Grid.Column="0" Text="Start delay:" VerticalAlignment="Center"/>
                                         <NumericUpDown Grid.Column="2" Value="{Binding ScreenRecordStartDelay}" Minimum="0" Maximum="60" Increment="0.1" FormatString="0.0" MinWidth="120"/>
                                         <TextBlock Grid.Column="4" Text="seconds" VerticalAlignment="Center"/>
                                    </Grid>
                                    <Grid ColumnDefinitions="Auto, 10, *">
                                         <TextBlock Grid.Column="0" Text="Recording intent:" VerticalAlignment="Center"/>
                                         <ComboBox Grid.Column="2"
                                                   ItemsSource="{Binding RecordingIntents}"
                                                   SelectedItem="{Binding RecordingIntent}"
                                                   HorizontalAlignment="Stretch"
                                                   MinWidth="150"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <!-- After Capture Tasks Section -->
                        <StackPanel Spacing="10">
                            <TextBlock Text="After capture" FontWeight="SemiBold"/>
                            <Border BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" BorderThickness="1" CornerRadius="4" Padding="10">
                                <StackPanel Spacing="10">
                                    <TextBlock Text="Choose actions to perform automatically after capturing" 
                                               FontSize="12" 
                                               Foreground="Gray" 
                                               Margin="0,0,0,4"/>
                                    <CheckBox IsChecked="{Binding SaveImageToFile}" 
                                              Content="Save image to file"/>
                                    <CheckBox IsChecked="{Binding CopyImageToClipboard}" 
                                              Content="Copy image to clipboard"/>
                                    <CheckBox IsChecked="{Binding UploadImageToHost}" 
                                              Content="Upload image to host"
                                              FontWeight="SemiBold"/>
                                    <CheckBox IsChecked="{Binding ApplyImageEffects}"
                                              Content="Apply image effects"/>
                                    <CheckBox IsChecked="{Binding AnnotateImage}" 
                                              Content="Annotate image"/>
                                    <CheckBox IsChecked="{Binding ShowAfterCaptureWindow}" 
                                              Content="Show after capture window"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="Image">
                <Grid RowDefinitions="Auto, *">
                    <StackPanel Grid.Row="0" Margin="10" Spacing="20" Orientation="Horizontal">
                        <StackPanel Spacing="10" MinWidth="200">
                            <TextBlock Text="Quality" FontWeight="SemiBold"/>
                             <Border BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" BorderThickness="1" CornerRadius="4" Padding="10">
                                <StackPanel Spacing="10">
                                    <Grid ColumnDefinitions="Auto, 10, *">
                                        <TextBlock Grid.Column="0" Text="Format:" VerticalAlignment="Center"/>
                                        <ComboBox Grid.Column="2" ItemsSource="{Binding ImageFormats}" SelectedItem="{Binding ImageFormat}" HorizontalAlignment="Stretch"/>
                                    </Grid>
                                    <Grid ColumnDefinitions="Auto, 10, *">
                                        <TextBlock Grid.Column="0" Text="JPEG Quality:" VerticalAlignment="Center"/>
                                        <NumericUpDown Grid.Column="2" Value="{Binding ImageJPEGQuality}" Minimum="0" Maximum="100" Increment="1"/>
                                    </Grid>
                                </StackPanel>
                             </Border>
                        </StackPanel>
                        
                        <StackPanel Spacing="10" MinWidth="200">
                            <TextBlock Text="Thumbnail" FontWeight="SemiBold"/>
                             <Border BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" BorderThickness="1" CornerRadius="4" Padding="10">
                                <StackPanel Spacing="10">
                                    <Grid ColumnDefinitions="Auto, 10, *">
                                        <TextBlock Grid.Column="0" Text="Width:" VerticalAlignment="Center"/>
                                        <NumericUpDown Grid.Column="2" Value="{Binding ThumbnailWidth}" Minimum="0" Maximum="10000" Increment="10"/>
                                    </Grid>
                                    <Grid ColumnDefinitions="Auto, 10, *">
                                        <TextBlock Grid.Column="0" Text="Height:" VerticalAlignment="Center"/>
                                        <NumericUpDown Grid.Column="2" Value="{Binding ThumbnailHeight}" Minimum="0" Maximum="10000" Increment="10"/>
                                    </Grid>
                                    <Grid ColumnDefinitions="Auto, 10, *">
                                        <TextBlock Grid.Column="0" Text="Name:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="2" Text="{Binding ThumbnailName}"/>
                                    </Grid>
                                    <CheckBox IsChecked="{Binding ThumbnailCheckSize}" Content="Save thumbnail only if smaller than image"/>
                                </StackPanel>
                             </Border>
                        </StackPanel>
                    </StackPanel>


                </Grid>
            </TabItem>

            <!-- Effects Tab -->
            <TabItem Header="Effects">
                <Grid RowDefinitions="Auto, *" Margin="20">
                    <!-- Top Toolbar -->
                    <Border Grid.Row="0" Margin="0,0,0,10" Background="{DynamicResource ControlFillColorDefaultBrush}" CornerRadius="4" Padding="10">
                         <Grid ColumnDefinitions="*, Auto">
                              <StackPanel Orientation="Horizontal" Spacing="10" VerticalAlignment="Center">
                                  <TextBlock Text="Preset:" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                  <TextBlock Text="{Binding ImageEffects.Name}" VerticalAlignment="Center"/>
                              </StackPanel>
                              <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="10">
                                  <Button Command="{Binding ImageEffects.ImportEffectsCommand}" Content="Import..."/>
                                  <Button Command="{Binding ImageEffects.SavePresetCommand}" Content="Export..."/>
                              </StackPanel>
                         </Grid>
                    </Border>

                    <!-- Main Content -->
                    <Grid Grid.Row="1" ColumnDefinitions="250, 10, 300, 10, *">
                         <!-- Effects List -->
                         <Grid Grid.Column="0" RowDefinitions="Auto, *, Auto">
                             <TextBlock Grid.Row="0" Text="Active Effects" FontWeight="SemiBold" Margin="0,0,0,5"/>
                             <Border Grid.Row="1" BorderThickness="1" BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" CornerRadius="4">
                                 <ListBox ItemsSource="{Binding ImageEffects.Effects}" SelectedItem="{Binding ImageEffects.SelectedEffect}" Background="Transparent" BorderThickness="0">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Name}"/>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                 </ListBox>
                             </Border>
                             <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="5" Margin="0,5,0,0">
                                  <Button Content="Add Effect">
                                      <Button.Flyout>
                                          <Flyout Placement="BottomEdgeAlignedLeft" ShowMode="Standard">
                                              <Menu ItemsSource="{Binding ImageEffects.AvailableEffects}">
                                                  <Menu.Styles>
                                                      <Style Selector="MenuItem" x:DataType="vm:EffectCategory">
                                                          <Setter Property="Header" Value="{Binding Name}"/>
                                                          <Setter Property="ItemsSource" Value="{Binding Effects}"/>
                                                      </Style>
                                                      <Style Selector="MenuItem" x:DataType="vm:EffectType">
                                                          <Setter Property="Header" Value="{Binding Name}"/>
                                                          <Setter Property="Command" Value="{Binding $parent[UserControl].DataContext.ImageEffects.AddEffectCommand}"/>
                                                          <Setter Property="CommandParameter" Value="{Binding Type}"/>
                                                      </Style>
                                                  </Menu.Styles>
                                              </Menu>
                                          </Flyout>
                                      </Button.Flyout>
                                  </Button>
                                  <Button Command="{Binding ImageEffects.RemoveEffectCommand}" Content="Remove"/>
                             </StackPanel>
                         </Grid>

                         <!-- Properties -->
                         <Grid Grid.Column="2" RowDefinitions="Auto, *">
                             <TextBlock Grid.Row="0" Text="Properties" FontWeight="SemiBold" Margin="0,0,0,5"/>
                             <Border Grid.Row="1" BorderThickness="1" BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" CornerRadius="4" Padding="5">
                                  <controls:PropertyGrid x:Name="EffectPropertyGrid" SelectedObject="{Binding ImageEffects.SelectedEffect}"/>
                             </Border>
                         </Grid>

                         <!-- Preview -->
                         <Grid Grid.Column="4" RowDefinitions="Auto, *">
                             <TextBlock Grid.Row="0" Text="Preview" FontWeight="SemiBold" Margin="0,0,0,5"/>
                             <Border Grid.Row="1" BorderThickness="1" BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" CornerRadius="4">
                                  <Image Source="{Binding ImageEffects.PreviewBitmap}" Stretch="Uniform" Margin="10"/>
                             </Border>
                         </Grid>
                    </Grid>
                </Grid>
            </TabItem>

            <!-- Upload Tab -->
            <TabItem Header="Upload">
                <ScrollViewer>
                    <StackPanel Margin="20" Spacing="20">
                        <StackPanel Spacing="10">
                            <TextBlock Text="File naming" FontWeight="SemiBold"/>
                            <Border BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" BorderThickness="1" CornerRadius="4" Padding="10">
                                <StackPanel Spacing="10">
                                    <Grid ColumnDefinitions="Auto, 10, *">
                                        <TextBlock Grid.Column="0" Text="Name pattern:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="2" Text="{Binding NameFormatPattern, Mode=TwoWay}"/>
                                    </Grid>
                                    <Grid ColumnDefinitions="Auto, 10, *">
                                        <TextBlock Grid.Column="0" Text="Active window name pattern:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="2" Text="{Binding NameFormatPatternActiveWindow, Mode=TwoWay}"/>
                                    </Grid>
                                    <CheckBox IsChecked="{Binding FileUploadUseNamePattern}" Content="Use name pattern for file uploaders"/>
                                    <CheckBox IsChecked="{Binding FileUploadReplaceProblematicCharacters}" Content="Replace potentially problematic characters"/>
                                    <CheckBox IsChecked="{Binding URLRegexReplace}" Content="Perform regex replace on URL"/>
                                    <Grid ColumnDefinitions="Auto, 10, *" IsVisible="{Binding URLRegexReplace}">
                                        <TextBlock Grid.Column="0" Text="Regex pattern:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="2" Text="{Binding URLRegexReplacePattern, Mode=TwoWay}"/>
                                    </Grid>
                                    <Grid ColumnDefinitions="Auto, 10, *" IsVisible="{Binding URLRegexReplace}">
                                        <TextBlock Grid.Column="0" Text="Replacement:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="2" Text="{Binding URLRegexReplaceReplacement, Mode=TwoWay}"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <StackPanel Spacing="10">
                            <TextBlock Text="Clipboard upload" FontWeight="SemiBold"/>
                            <Border BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" BorderThickness="1" CornerRadius="4" Padding="10">
                                <StackPanel Spacing="10">
                                    <CheckBox IsChecked="{Binding ClipboardUploadURLContents}" Content="Upload URL contents"/>
                                    <CheckBox IsChecked="{Binding ClipboardUploadShortenURL}" Content="Shorten URL"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>



                        <!-- After Upload Tasks Section -->
                        <StackPanel Spacing="10">
                            <TextBlock Text="After upload" FontWeight="SemiBold"/>
                            <Border BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" BorderThickness="1" CornerRadius="4" Padding="10">
                                <StackPanel Spacing="10">
                                    <TextBlock Text="Choose actions to perform automatically after upload" 
                                               FontSize="12" 
                                               Foreground="Gray" 
                                               Margin="0,0,0,4"/>
                                    <CheckBox IsChecked="{Binding CopyURLToClipboard}" 
                                              Content="Copy URL to clipboard"
                                              FontWeight="SemiBold"/>
                                    <CheckBox IsChecked="{Binding UseURLShortener}" 
                                              Content="Use URL shortener"/>
                                    <CheckBox IsChecked="{Binding ShareURL}" 
                                              Content="Share URL"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Actions Tab -->
            <TabItem Header="Actions">
                 <TextBlock Text="Actions actions placeholder" Margin="20" Foreground="Gray"/>
            </TabItem>

             <!-- Advanced Tab -->
            <TabItem Header="Advanced">
                 <TextBlock Text="Advanced settings placeholder" Margin="20" Foreground="Gray"/>
            </TabItem>

            <!-- Tools Tab -->
            <TabItem Header="Tools">
                <ScrollViewer>
                    <StackPanel Margin="20" Spacing="20">
                        <StackPanel Spacing="10">
                            <TextBlock Text="Capture" FontWeight="SemiBold"/>
                            <Border BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" BorderThickness="1" CornerRadius="4" Padding="10">
                                <StackPanel Spacing="10">
                                    <TextBlock Text="Configure FFmpeg fallback options for screen recording and audio capture."
                                               Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                               FontSize="12"
                                               TextWrapping="Wrap"/>
                                    <Button Content="Configure FFmpeg..."
                                            Command="{Binding OpenFFmpegOptionsCommand}"
                                            HorizontalAlignment="Left"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <StackPanel Spacing="10" IsVisible="{Binding IsIndexFolderJob}">
                            <TextBlock Text="Index folder" FontWeight="SemiBold"/>
                            <Border BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" BorderThickness="1" CornerRadius="4" Padding="10">
                                <StackPanel Spacing="10">
                                    <Grid ColumnDefinitions="Auto, 10, *, Auto">
                                        <TextBlock Grid.Column="0" Text="Folder:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="2" Text="{Binding IndexerFolderPath}" Watermark="Folder to index"/>
                                        <Button Grid.Column="3" Content="Browse..." Command="{Binding BrowseIndexerFolderCommand}" Margin="10,0,0,0"/>
                                    </Grid>

                                    <Grid ColumnDefinitions="Auto, 10, *">
                                        <TextBlock Grid.Column="0" Text="Output:" VerticalAlignment="Center"/>
                                        <ComboBox Grid.Column="2" ItemsSource="{Binding IndexerOutputs}" SelectedItem="{Binding IndexerOutput}" Width="160"/>
                                    </Grid>

                                    <Grid ColumnDefinitions="Auto, 10, *">
                                        <TextBlock Grid.Column="0" Text="Max depth:" VerticalAlignment="Center"/>
                                        <NumericUpDown Grid.Column="2" Value="{Binding IndexerMaxDepthLevel}" Minimum="0" Maximum="50" Width="120"/>
                                    </Grid>

                                    <CheckBox IsChecked="{Binding IndexerSkipHiddenFolders}" Content="Skip hidden folders"/>
                                    <CheckBox IsChecked="{Binding IndexerSkipHiddenFiles}" Content="Skip hidden files"/>
                                    <CheckBox IsChecked="{Binding IndexerSkipFiles}" Content="Skip files"/>
                                    <CheckBox IsChecked="{Binding IndexerShowSizeInfo}" Content="Show size info"/>
                                    <CheckBox IsChecked="{Binding IndexerAddFooter}" Content="Add footer"/>

                                    <Grid ColumnDefinitions="Auto, 10, *">
                                        <TextBlock Grid.Column="0" Text="Indentation:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="2" Text="{Binding IndexerIndentationText}" Width="160"/>
                                    </Grid>

                                    <CheckBox IsChecked="{Binding IndexerAddEmptyLineAfterFolders}" Content="Add empty line after folders"/>

                                    <Separator Margin="0,5"/>
                                    <TextBlock Text="HTML options" FontWeight="SemiBold" FontSize="12"/>
                                    <CheckBox IsChecked="{Binding IndexerUseCustomCssFile}" Content="Use custom CSS file"/>
                                    <Grid ColumnDefinitions="Auto, 10, *, Auto" IsEnabled="{Binding IndexerUseCustomCssFile}">
                                        <TextBlock Grid.Column="0" Text="CSS path:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="2" Text="{Binding IndexerCustomCssFilePath}"/>
                                        <Button Grid.Column="3" Content="Browse..." Command="{Binding BrowseIndexerCssFileCommand}" Margin="10,0,0,0"/>
                                    </Grid>
                                    <CheckBox IsChecked="{Binding IndexerDisplayPath}" Content="Display path for subfolders"/>
                                    <CheckBox IsChecked="{Binding IndexerDisplayPathLimited}"
                                              Content="Limit display path to root folder"
                                              IsEnabled="{Binding IndexerDisplayPath}"/>

                                    <Separator Margin="0,5"/>
                                    <TextBlock Text="XML / JSON options" FontWeight="SemiBold" FontSize="12"/>
                                    <CheckBox IsChecked="{Binding IndexerUseAttribute}" Content="Write file info as attribute (XML)"/>
                                    <CheckBox IsChecked="{Binding IndexerCreateParseableJson}" Content="Create parseable JSON"/>
                                    <CheckBox IsChecked="{Binding IndexerBinaryUnits}" Content="Use binary units for size"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>
    </Grid>
</UserControl>
