<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:XerahS.UI.ViewModels"
        x:Class="XerahS.UI.Views.OcrWindow"
        x:DataType="vm:OcrViewModel"
        Title="OCR - Text Recognition"
        Width="600" Height="450"
        MinWidth="400" MinHeight="300"
        WindowStartupLocation="CenterScreen"
        AutomationProperties.Name="OCR Text Recognition Window">

  <Grid RowDefinitions="Auto,*,Auto" Margin="16">

    <!-- Options Bar -->
    <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="16" Margin="0,0,0,12">

      <StackPanel Orientation="Horizontal" Spacing="8">
        <TextBlock Text="Language:" VerticalAlignment="Center" />
        <ComboBox ItemsSource="{Binding AvailableLanguages}"
                  SelectedItem="{Binding SelectedLanguage}"
                  MinWidth="160"
                  AutomationProperties.Name="OCR Language">
          <ComboBox.ItemTemplate>
            <DataTemplate>
              <TextBlock Text="{Binding DisplayName}" />
            </DataTemplate>
          </ComboBox.ItemTemplate>
        </ComboBox>
      </StackPanel>

      <StackPanel Orientation="Horizontal" Spacing="8">
        <TextBlock Text="Scale:" VerticalAlignment="Center" />
        <ComboBox ItemsSource="{Binding ScaleFactorOptions}"
                  SelectedItem="{Binding ScaleFactor}"
                  MinWidth="70"
                  AutomationProperties.Name="Scale Factor" />
      </StackPanel>

      <CheckBox Content="Single line"
                IsChecked="{Binding SingleLine}"
                VerticalAlignment="Center"
                AutomationProperties.Name="Single line output mode" />

    </StackPanel>

    <!-- Result Text Area -->
    <Grid Grid.Row="1">
      <TextBox Text="{Binding ResultText, Mode=TwoWay}"
               AcceptsReturn="True"
               TextWrapping="Wrap"
               IsReadOnly="False"
               VerticalContentAlignment="Top"
               Watermark="OCR result will appear here..."
               AutomationProperties.Name="OCR recognized text" />

      <!-- Processing overlay -->
      <Border Background="#80000000"
              CornerRadius="4"
              IsVisible="{Binding IsProcessing}"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Stretch">
        <StackPanel HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Spacing="8">
          <ProgressBar IsIndeterminate="True"
                       Width="200" />
          <TextBlock Text="Processing..."
                     Foreground="White"
                     HorizontalAlignment="Center" />
        </StackPanel>
      </Border>
    </Grid>

    <!-- Bottom Bar -->
    <Grid Grid.Row="2" ColumnDefinitions="Auto,Auto,*,Auto" Margin="0,12,0,0">

      <Button Grid.Column="0"
              Content="Select Region"
              Command="{Binding SelectRegionCommand}"
              MinWidth="110"
              AutomationProperties.Name="Select new screen region for OCR" />

      <Button Grid.Column="1"
              Content="Copy All"
              Command="{Binding CopyToClipboardCommand}"
              Classes="accent"
              Margin="8,0,0,0"
              MinWidth="90"
              IsEnabled="{Binding HasResult}"
              AutomationProperties.Name="Copy all recognized text to clipboard" />

      <TextBlock Grid.Column="3"
                 Text="{Binding StatusText}"
                 VerticalAlignment="Center"
                 Opacity="0.7"
                 FontSize="12" />
    </Grid>

  </Grid>

</Window>
