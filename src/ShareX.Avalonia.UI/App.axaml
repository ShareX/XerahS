<Application xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="using:XerahS.UI"
             xmlns:vm="using:XerahS.UI.ViewModels"
             xmlns:views="using:XerahS.UI.Views"
             xmlns:converters="clr-namespace:ShareX.Editor.Converters;assembly=ShareX.Editor"
             xmlns:uiconverters="clr-namespace:XerahS.UI.Converters"
             xmlns:sty="using:FluentAvalonia.Styling"
             xmlns:core="using:XerahS.Core"
             x:Class="XerahS.UI.App"
             RequestedThemeVariant="Default">
             <!-- "Default" ThemeVariant follows system theme variant. "Dark" or "Light" are other available options. -->

    <Application.Resources>
        <converters:ActiveToolToBackgroundConverter x:Key="ActiveToolToBackground"/>
        <converters:SelectedColorToBorderConverter x:Key="SelectedColorToBorder"/>
        <converters:SelectedWidthToBackgroundConverter x:Key="SelectedWidthToBackground"/>
        <converters:BoolToActiveBackgroundConverter x:Key="BoolToActiveBackgroundConverter"/>
        <converters:EqualsConverter x:Key="EqualsConverter"/>
        <uiconverters:BoolToRecordingColorConverter x:Key="BoolToRecordingColorConverter"/>
    </Application.Resources>


    <Application.DataTemplates>
        <local:ViewLocator/>
        
        <!-- Manual DataTemplate registrations for modal dialogs -->
        <DataTemplate DataType="vm:ProviderCatalogViewModel">
            <views:ProviderCatalogView/>
        </DataTemplate>
    </Application.DataTemplates>
  
    <Application.Styles>
        <!-- TODO: Re-enable dark theme when ready -->
        <!-- <StyleInclude Source="avares://ShareX.Avalonia.UI/Themes/Dark/DarkTheme.axaml" /> -->
        <sty:FluentAvaloniaTheme />
        <Style Selector="Button.DarkButton">
            <Setter Property="Background" Value="#25263A"/>
            <Setter Property="Foreground" Value="#E2E8F0"/>
            <Setter Property="BorderBrush" Value="#3B3B52"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
        </Style>
        <Style Selector="Button.DarkButton.active">
            <Setter Property="Background" Value="#8B5CF6"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#8B5CF6"/>
        </Style>
    </Application.Styles>

    <TrayIcon.Icons>
        <TrayIcons>
            <TrayIcon Icon="avares://ShareX.Avalonia.UI/Assets/ShareX.iconset/icon_16x16.png"
                      ToolTipText="ShareX"
                      IsVisible="{Binding ShowTray, Source={x:Static local:TrayIconHelper.Instance}}"
                      Command="{Binding TrayClickCommand, Source={x:Static local:TrayIconHelper.Instance}}"
                      Clicked="TrayIcon_Clicked">
                <TrayIcon.Menu>
                    <NativeMenu>
                        <NativeMenuItem Header="{Binding Workflow1Name, Source={x:Static local:TrayIconHelper.Instance}}" Command="{Binding Workflow1Command, Source={x:Static local:TrayIconHelper.Instance}}" IsVisible="{Binding HasWorkflow1, Source={x:Static local:TrayIconHelper.Instance}}"/>
                        <NativeMenuItem Header="{Binding Workflow2Name, Source={x:Static local:TrayIconHelper.Instance}}" Command="{Binding Workflow2Command, Source={x:Static local:TrayIconHelper.Instance}}" IsVisible="{Binding HasWorkflow2, Source={x:Static local:TrayIconHelper.Instance}}"/>
                        <NativeMenuItem Header="{Binding Workflow3Name, Source={x:Static local:TrayIconHelper.Instance}}" Command="{Binding Workflow3Command, Source={x:Static local:TrayIconHelper.Instance}}" IsVisible="{Binding HasWorkflow3, Source={x:Static local:TrayIconHelper.Instance}}"/>
                        <NativeMenuItemSeparator/>
                        <NativeMenuItem Header="Open Main Window" Command="{Binding OpenMainWindowCommand, Source={x:Static local:TrayIconHelper.Instance}}"/>
                        <NativeMenuItem Header="Settings" Command="{Binding OpenSettingsCommand, Source={x:Static local:TrayIconHelper.Instance}}"/>
                        <NativeMenuItemSeparator/>
                        <NativeMenuItem Header="Exit" Command="{Binding ExitCommand, Source={x:Static local:TrayIconHelper.Instance}}"/>
                    </NativeMenu>
                </TrayIcon.Menu>
            </TrayIcon>
        </TrayIcons>
    </TrayIcon.Icons>
</Application>
