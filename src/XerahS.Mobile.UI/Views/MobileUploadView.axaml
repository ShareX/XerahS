<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:XerahS.Mobile.UI.ViewModels"
             x:Class="XerahS.Mobile.UI.Views.MobileUploadView"
             x:DataType="vm:MobileUploadViewModel">

    <Grid RowDefinitions="Auto, *">

        <!-- Header -->
        <Grid Grid.Row="0"
              Classes="adaptive-navbar"
              ColumnDefinitions="*, Auto, Auto">

            <!-- Title -->
            <TextBlock Grid.Column="0"
                       Text="XerahS"
                       Classes="adaptive-navbar-title"
                       VerticalAlignment="Center"
                       Margin="20,0"/>

            <Button Grid.Column="1"
                    Content="History"
                    Command="{Binding OpenHistoryCommand}"
                    Classes="adaptive-secondary"
                    Margin="4,0"
                    ToolTip.Tip="History"/>

            <Button Grid.Column="2"
                    Content="Settings"
                    Command="{Binding OpenSettingsCommand}"
                    Classes="adaptive-secondary"
                    Margin="4,0"
                    ToolTip.Tip="Settings"/>
        </Grid>

        <!-- Main Content -->
        <ScrollViewer Grid.Row="1" Classes="adaptive-scroll">
            <StackPanel Margin="20" Spacing="16">

                <!-- Subtitle -->
                <TextBlock Text="Share &amp; Upload"
                           FontSize="16"
                           Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,10" />

                <!-- Status -->
                <TextBlock Text="{Binding StatusText}"
                           HorizontalAlignment="Center"
                           TextWrapping="Wrap"
                           TextAlignment="Center" />

                <Button Content="Choose Photo or File"
                        Click="OnChooseFilesClick"
                        Classes="adaptive-primary"
                        HorizontalAlignment="Center"
                        Margin="0,4" />

                <!-- Progress -->
                <ProgressBar IsIndeterminate="True"
                             IsVisible="{Binding IsUploading}"
                             Margin="0,8" />

                <!-- Results list -->
                <ItemsControl ItemsSource="{Binding Results}"
                              x:Name="ResultsList"
                              Margin="0,8">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate x:DataType="vm:UploadResultItem">
                            <Border Classes="adaptive-card">
                                <StackPanel Spacing="8">

                                    <!-- File name -->
                                    <TextBlock Text="{Binding FileName}"
                                               FontWeight="SemiBold" />

                                    <!-- URL (if success) -->
                                    <TextBlock Text="{Binding Url}"
                                               IsVisible="{Binding HasUrl}"
                                               Foreground="{DynamicResource SystemAccentColor}"
                                               TextWrapping="Wrap" />

                                    <!-- Error (if failed) -->
                                    <TextBlock Text="{Binding Error}"
                                               IsVisible="{Binding Error, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
                                               Foreground="Red"
                                               TextWrapping="Wrap" />

                                    <!-- Copy URL button -->
                                    <Button Content="Copy URL"
                                            IsVisible="{Binding HasUrl}"
                                            Command="{Binding CopyUrlCommand}"
                                            CommandParameter="{Binding Url}"
                                            Classes="adaptive-secondary"
                                            HorizontalAlignment="Left" />

                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

            </StackPanel>
        </ScrollViewer>
    </Grid>

</UserControl>
