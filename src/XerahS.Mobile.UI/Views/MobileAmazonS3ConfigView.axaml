<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:XerahS.Mobile.UI.ViewModels"
             x:Class="XerahS.Mobile.UI.Views.MobileAmazonS3ConfigView"
             x:DataType="vm:MobileAmazonS3ConfigViewModel">

    <ScrollViewer>
        <StackPanel Margin="20" Spacing="20">

            <!-- Header -->
            <StackPanel Spacing="8">
                <TextBlock Text="Amazon S3"
                           FontSize="24"
                           FontWeight="Bold"/>
                <TextBlock Text="Configure your S3 bucket for file uploads"
                           FontSize="14"
                           Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                           TextWrapping="Wrap"/>
            </StackPanel>

            <!-- Status Message -->
            <Border Background="{DynamicResource SystemFillColorCautionBackground}"
                    BorderBrush="{DynamicResource SystemFillColorCaution}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16"
                    IsVisible="{Binding StatusMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                <TextBlock Text="{Binding StatusMessage}"
                           TextWrapping="Wrap"
                           Foreground="{DynamicResource SystemFillColorCaution}"/>
            </Border>

            <!-- Access Key ID -->
            <StackPanel Spacing="8">
                <TextBlock Text="Access Key ID"
                           FontWeight="SemiBold"/>
                <TextBox Text="{Binding AccessKeyId, UpdateSourceTrigger=PropertyChanged}"
                         Watermark="AKIA..."
                         FontFamily="Consolas, Monospace"
                         Height="44"
                         Padding="12,8"/>
            </StackPanel>

            <!-- Secret Access Key -->
            <StackPanel Spacing="8">
                <TextBlock Text="Secret Access Key"
                           FontWeight="SemiBold"/>
                <TextBox Text="{Binding SecretAccessKey, UpdateSourceTrigger=PropertyChanged}"
                         Watermark="Enter your secret key"
                         PasswordChar="●"
                         FontFamily="Consolas, Monospace"
                         Height="44"
                         Padding="12,8"/>
            </StackPanel>

            <!-- Bucket Name -->
            <StackPanel Spacing="8">
                <TextBlock Text="Bucket Name"
                           FontWeight="SemiBold"/>
                <TextBox Text="{Binding BucketName, UpdateSourceTrigger=PropertyChanged}"
                         Watermark="my-bucket-name"
                         Height="44"
                         Padding="12,8"/>
                <TextBlock Text="The S3 bucket where files will be uploaded"
                           FontSize="12"
                           Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"/>
            </StackPanel>

            <!-- Region -->
            <StackPanel Spacing="8">
                <TextBlock Text="Region"
                           FontWeight="SemiBold"/>
                <ComboBox ItemsSource="{x:Static vm:MobileAmazonS3ConfigViewModel.Regions}"
                          SelectedIndex="{Binding RegionIndex}"
                          HorizontalAlignment="Stretch"
                          Height="44"
                          Padding="12,8">
                    <ComboBox.ItemTemplate>
                        <DataTemplate x:DataType="vm:S3RegionOption">
                            <StackPanel>
                                <TextBlock Text="{Binding DisplayName}"/>
                            </StackPanel>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
            </StackPanel>

            <!-- Object Prefix -->
            <StackPanel Spacing="8">
                <TextBlock Text="Object Prefix (Optional)"
                           FontWeight="SemiBold"/>
                <TextBox Text="{Binding ObjectPrefix, UpdateSourceTrigger=PropertyChanged}"
                         Watermark="ShareX/%y/%mo"
                         Height="44"
                         Padding="12,8"/>
                <TextBlock Text="Use %y for year, %mo for month, %d for day"
                           FontSize="12"
                           Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"/>
            </StackPanel>

            <!-- Custom Domain -->
            <StackPanel Spacing="8">
                <CheckBox Content="Use Custom Domain (CDN)"
                          IsChecked="{Binding UseCustomDomain}"/>
                <TextBox Text="{Binding CustomDomain, UpdateSourceTrigger=PropertyChanged}"
                         Watermark="https://cdn.example.com"
                         IsEnabled="{Binding UseCustomDomain}"
                         Height="44"
                         Padding="12,8"/>
            </StackPanel>

            <!-- Public ACL -->
            <CheckBox Content="Make uploads publicly accessible"
                      IsChecked="{Binding SetPublicAcl}"/>

            <!-- Action Buttons -->
            <StackPanel Spacing="12" Margin="0,20,0,0">
                <Button Content="Save Configuration"
                        Command="{Binding SaveCommand}"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Center"
                        Height="48"
                        Classes="accent"
                        FontWeight="SemiBold"/>
                
                <Button Content="Test Connection"
                        Command="{Binding TestCommand}"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Center"
                        Height="48"
                        IsVisible="{Binding IsTesting, Converter={x:Static BoolConverters.Not}}"/>
                
                <ProgressBar IsIndeterminate="True"
                             IsVisible="{Binding IsTesting}"
                             Margin="0,12"/>
            </StackPanel>

            <!-- Help Text -->
            <Border Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}"
                    CornerRadius="8"
                    Padding="16"
                    Margin="0,10,0,40">
                <StackPanel Spacing="8">
                    <TextBlock Text="How to get AWS credentials:"
                               FontWeight="SemiBold"/>
                    <TextBlock Text="1. Go to AWS Console → IAM → Users"
                               FontSize="13"/>
                    <TextBlock Text="2. Create a user with 'AmazonS3FullAccess' permission"
                               FontSize="13"/>
                    <TextBlock Text="3. Create access keys and copy them here"
                               FontSize="13"/>
                </StackPanel>
            </Border>

        </StackPanel>
    </ScrollViewer>

</UserControl>
